{"version":3,"sources":["js/src/habit.jsx"],"names":[],"mappings":"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","file":"js/src/habit.jsx","sourcesContent":["\n// Create scope\nconst habitWidget = (function () {\n\tconst LatestHabit = React.createClass({\n\t\trender() {\n\t\t\treturn (\n\t\t\t\t<div className=\"habit-list\">\n\t\t\t\t\tLatest task completed:\n\t\t\t\t\t<div className=\"habit\">\n\t\t\t\t\t\t<span className=\"name\">{this.props.text}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\t});\n\n\tconst LevelIndicator = React.createClass({\n\t\trender() { return (<span className=\"level\">Lvl {this.props.level}</span>); }\n\t});\n\n\tconst ProfileName = React.createClass({\n\t\trender() { return (<span className=\"profile-name\">{this.props.name}</span>); }\n\t});\n\n\tconst GlyphLabel = React.createClass({\n\t\trender() {\n\t\t\tconst glyphs = {\n\t\t\t\t\"hp\": \"fa fa-heart\",\n\t\t\t\t\"exp\": \"fa fa-star\",\n\t\t\t\t\"mp\": \"fa fa-fire\"\n\t\t\t};\n\t\t\tconst thisGlyph = glyphs[this.props.type];\n\t\t\treturn (\n\t\t\t\t<div className=\"glyph-label\">\n\t\t\t\t\t<i className={thisGlyph}></i>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\t});\n\n\tconst StatBar = React.createClass({\n\t\trender() {\n\t\t\tconst style = {width: Math.floor((this.props.statValue / this.props.max)*100) + '%' };\n\t\t\tconst classes = \"meter \" + this.props.name;\n\t\t\treturn (\n\t\t\t\t<div>\n\t\t\t\t\t<GlyphLabel type={this.props.name} />\n\t\t\t\t\t<div className=\"stat-bar\">\n\t\t\t\t\t\t<div className={classes} style={style}></div>\n\t\t\t\t\t\t<span className=\"text\">\n\t\t\t\t\t\t\t{this.props.statValue.toFixed()} / {this.props.max}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\t});\n\n\tconst Habit = React.createClass({\n\t\tprocessData(data) {\n\t\t\tconst stats = data.user.stats;\n\n\t\t\t// https://github.com/HabitRPG/habitrpg/blob/develop/common/script/index.coffee#L125\n\t\t\tconst computeExp = (lvl) => Math.round(((Math.pow(lvl, 2) * 0.25) + (10 * lvl) + 139.75) / 10) * 10;\n\t\t\t// https://github.com/HabitRPG/habitrpg/blob/develop/common/script/index.coffee#L1754\n\t\t\tconst computeMaxMP = (int) => int*2 + 30;\n\n\t\t\tstats.toNextLevel = computeExp(stats.lvl);\n\t\t\tstats.maxMP = computeMaxMP(stats.int);\n\t\t\tstats.maxHealth = 50; // constant\n\t\t\treturn data;\n\t\t},\n\t\tloadData(url, cb) {\n\t\t\tconsole.log('loading...');\n\t\t\tqwest.get(url, null, {\n\t\t\t\tcache: false\n\t\t\t})\n\t\t\t.then((data) => this.setState( this.processData(data) ))\n\t\t\t.catch((e, data) => {\n\t\t\t\tconsole.log(e);\n\t\t\t\tconsole.log(data);\n\t\t\t});\n\t\t},\n\t\tgetInitialState() {\n\t\t\treturn {\n\t\t\t\ttask: { text: 'Loading...' },\n\t\t\t\tuser: {\n\t\t\t\t\tstats: {\n\t\t\t\t\t\thp: 0,\n\t\t\t\t\t\tmp: 0,\n\t\t\t\t\t\texp: 0,\n\t\t\t\t\t\tlvl: 0,\n\t\t\t\t\t\tmaxHealth: 50,\n\t\t\t\t\t\tmaxMP: 0,\n\t\t\t\t\t\ttoNextLevel: 0\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tcomponentDidMount() {\n\t\t\tconsole.log('mounted');\n\t\t\tthis.loadData(this.props.url);\n\t\t},\n\t\trender() {\n\t\t\treturn (\n\t\t\t\t<div className=\"panel\">\n\t\t\t\t\t<div className=\"profile-info\">\n\t\t\t\t\t\t<ProfileName name={this.props.name} />\n\t\t\t\t\t\t<LevelIndicator level={this.state.user.stats.lvl} />\n\t\t\t\t\t</div>\n\t\t\t\t\t<StatBar name=\"hp\" statValue={this.state.user.stats.hp} max={this.state.user.stats.maxHealth} />\n\t\t\t\t\t<StatBar name=\"exp\" statValue={this.state.user.stats.exp} max={this.state.user.stats.toNextLevel} />\n\t\t\t\t\t<StatBar name=\"mp\" statValue={this.state.user.stats.mp} max={this.state.user.stats.maxMP} />\n\t\t\t\t\t<LatestHabit text={this.state.task.text} />\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\t});\n\n\treturn {\n\t\trender: (id, name, url) => React.render(\n\t\t\t<Habit url={url} name={name} />,\n\t\t\tdocument.getElementById(id)\n\t\t)\n\t};\n})();"]}